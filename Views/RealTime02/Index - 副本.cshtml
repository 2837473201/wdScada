@{
    ViewBag.Title = "分布页";
    Layout = "~/Views/Shared/_LayoutNew4.cshtml";
}

@section HeadSection{
    
  
    
}


@section FootScript{
    @*<script type="text/javascript" src="~/js/RealTime02/realtime02.js"></script>*@
}
<style>
    	#village h4{
			 float:left;
        display:block;
        background:green;
        color:white;
        border-radius:10%;
        height:27px;
        line-height:16px;
       font-size:16px;
        box-shadow:0px 2px 2px rgba(0,0,0,0.2);
        padding:5px;
        text-align:center;
		}
        #village h4:hover{
            transform:rotate(7deg);
-ms-transform:rotate(7deg); 	/* IE 9 */
-moz-transform:rotate(7deg); 	/* Firefox */
-webkit-transform:rotate(7deg); /* Safari 和 Chrome */
-o-transform:rotate(7deg); 	/* Opera */
        }
		#village .col-md-4.col-xs-6:hover{
			color:hotpink;
		}
		@@media only screen and (min-width:768px){
			#village .border-p{
			border:1px solid #DDDDDD;
			}
		}
		
		#village p span:first-child{
			font-weight:bold;
		}
		#village .mb5{
			margin-bottom:5px;
		}
        .scale-title{
            background:#EF733A !important;
             
                 /*transform:scale(1.1);*/
/*-ms-transform:scale(1.1); 	/* IE 9 */*/
/*-moz-transform:scale(1.1); 	/* Firefox */*/
/*-webkit-transform:scale(1.1); /* Safari 和 Chrome */*/
/*-o-transform:scale(1.1); 	/* Opera */*/

  transform:rotate(7deg);
-ms-transform:rotate(7deg); 	/* IE 9 */
-moz-transform:rotate(7deg); 	/* Firefox */
-webkit-transform:rotate(7deg); /* Safari 和 Chrome */
-o-transform:rotate(7deg); 	/* Opera */
z-index:5;
        }
        div[id^="wrap"]{
            margin-bottom:15px;
        }
        .infobox>.infobox-icon{
             width:24px;
           height:24px;
        }
       .infobox>.infobox-icon>.ace-icon{
           width:12px;
           height:12px;
           background:#ddd;
       }
        /*.PressureDown{
            width:20px;height:20px;
            background-image:url(../../js/RealTime02/PressureDown.svg)
        }*/
        .svg-Temperature {
    background-image: url(../../img/TemperatureIn.svg);
}
.svgIcon {
    width: 40px;
    height: 40px;
    background-size: 40px 40px;
}
.infobox{
width:auto;

   
}
</style>
			<!--一个村落 start-->
<div class="col-sm-12 infobox-container" id="wrap0">
    <h4>大张庄</h4>
    <div col-sm-1="" class="infobox infobox-blue">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">53&nbsp;mm</span>
            <div class="infobox-content">雨量</div>
        </div>
    </div>
    <div col-sm-1="" class="infobox infobox-pink">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">53&nbsp;℃</span>
            <div class="infobox-content">空气温度</div>
        </div>
    </div>
    <div col-sm-1="" class="infobox infobox-red">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">53&nbsp;%</span>
            <div class="infobox-content">空气湿度</div>
        </div>
    </div>
    <div col-sm-1="" class="infobox infobox-orange2">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">53&nbsp;P</span>
            <div class="infobox-content">大气压</div>
        </div>
    </div>
    <div col-sm-1="" class="infobox infobox-blue2">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">53&nbsp;km/h</span>
            <div class="infobox-content">风速</div>
        </div>
    </div>
    <div col-sm-1="" class="infobox infobox-green">
        <div class="infobox-icon">
            <div class=""></div>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number">东南</span>
            <div class="infobox-content">风向</div>
        </div>
    </div>
    <div class="infobox infobox-green">
        <div class="infobox-icon"> <i class=""></i> </div>
        <div class="infobox-data">
            <span class="infobox-data-number">&nbsp;</span>
            <div class="infobox-content">&nbsp;</div>
        </div>
    </div>
    <div class="infobox infobox-green">
        <div class="infobox-icon"> <i class=""></i> </div>
        <div class="infobox-data">
            <span class="infobox-data-number">&nbsp;</span>
            <div class="infobox-content">&nbsp;</div>
        </div>
    </div>
</div>
            <!--一个村落 end-->


<div id="village" class="">
    <!--一个村落面板 start -->
    @*<div class="col-md-6 col-lg-4 mb5">
        <div class="col-md-12 border-p">
            <h4>马家洼村</h4>
            <div class="col-md-4 col-xs-12">
                <p><span>雨量：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>空气温度：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>空气湿度：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>大气压：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>风速：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>风向：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>土壤温度：</span><span>10mm</span></p>
            </div>
            <div class="col-md-4 col-xs-12">
                <p><span>土壤湿度：</span><span>10mm</span></p>
            </div>
        </div>
    </div>*@
    <!--一个村落面板 end -->
</div>


<style>
    /*.infobox{
        margin:0px;
    }*/
  
    
</style>
<script>
    $(function () {
        var aceInfoboxColor = ["green", "blue", "pink", "red", "orange2", "blue2"];
        var aceIcon2 = ["ace-icon fa fa-comments", "ace-icon fa fa-twitter", "ace-icon fa fa-cart", "ace-icon fa fa-flask", "ace-icon fa fa-flask", "ace-icon fa fa-flask"];
        var aceIcon3 = ["svgIcon svg-Temperature"];
        var aceIcon = [""];
        //生成模拟数据 start
        var data = [];
        refreshItemValues();
        //initAnalogData();
        //function initAnalogData() {
        //    var flag = 0;
        //    var cunzhuangArr = ["大张庄", "小李庄", "汪沟村", "蒋头村", "桑园", "新庄", "白寨村", "赵家庄", "史家庄", "后狮村"];
        //    for (var i = 0; i < 13; i++) {
        //        var data_obj = {};
        //        if (flag >= cunzhuangArr.length) {
        //            flag = 0;
        //        }
        //        data_obj["name"] = cunzhuangArr[flag];
        //        flag++;

        //        data_obj["yl"] = (Math.random() * 50).toFixed(1);
        //        data_obj["kqwd"] = (Math.random() * 50).toFixed(1);
        //        data_obj["kqsd"] = (Math.random() * 50).toFixed(1);
        //        data_obj["dqy"] = (Math.random() * 50).toFixed(1);
        //        data_obj["fs"] = (Math.random() * 50).toFixed(1);
        //        data_obj["fx"] = "东南";
        //        //if ((Math.random() * 100) > 50) {
        //        //    data_obj["trwd"] = (Math.random() * 50).toFixed(1);
        //        //    data_obj["trsd"] = (Math.random() * 50).toFixed(1);
        //        //}
        //        if (i % 2 == 0) {
        //            data_obj["trwd"] = (Math.random() * 50).toFixed(1);
        //            data_obj["trsd"] = (Math.random() * 50).toFixed(1);
        //        }
        //        data.push(data_obj);
        //    }
        //}
        //生成模拟数据 end
        var dataUnit = {
            yl: "&nbsp;mm",
            kqwd: "&nbsp;℃",
            kqsd: "&nbsp;%",
            dqy: "&nbsp;P",
            fs: "&nbsp;km/h",
            trwd: "&nbsp;%",
            trsd: "&nbsp;%"
        };
        var dataZh = {
            yl: "雨量",
            kqwd: "空气温度",
            kqsd: "空气湿度",
            dqy: "大气压",
            fs: "风速",
            fx: "风向",
            trwd: "土壤温度",
            trsd: "土壤湿度"
        };


        function initAnalogData(result) {
            var flag = 0;
            var cunzhuangArr = ["大张庄", "小李庄", "汪沟村", "蒋头村", "桑园", "新庄", "白寨村", "赵家庄", "史家庄", "后狮村"];
            //----------------------------TODO----------------------------------------
            //RealTime2Controller中固定了50个点，此处处理点值与实际显示数值的匹配操作（请根据实际情况进行修改）
            for (var i = 0; i < 50;) {
                var data_obj = {};
                data_obj["name"] = cunzhuangArr[flag];
                data_obj["yl"] = result[i++];
                data_obj["kqwd"] = result[i++];
                data_obj["kqsd"] = result[i++];
                data_obj["dqy"] = result[i++];
                data_obj["fs"] = result[i++];
                data_obj["fx"] = "东南";
                data.push(data_obj);
                flag++;
            }
        }




        function refreshItemValues() {
            $.get('../api/RealTime2', function (result) {
                console.log(result, "realtime200000000000000000");
                data = [];
                $("#village").html("");
                initAnalogData(result);
                console.log(data);
                dataValuePlus(data, dataUnit);
                arrEnToZh(data, dataZh);
                createPageContent();
                titleBindStyle();
                setTimeout(refreshItemValues, 2000);
            });
        }







        			//setInterval(function(){
        			//data=[];
        			//$("#village").html("");
        			//initAnalogData();
        			//dataValuePlus(data,dataUnit);
        			//arrEnToZh(data,dataZh);
        			//createPageContent();
        			//titleBindStyle();
        			//	},2000);
        //dataValuePlus(data, dataUnit);
        //arrEnToZh(data,dataZh);
        //createPageContent();
        function dataValuePlus(arr, obj) {
            //obj和obj[j]是要附加的信息；
            for (var i = 0; i < arr.length; i++) {
                for (var j in arr[i]) {
                    if (typeof (arr[i][j]) == "string") {
                        if (obj[j]) {
                            arr[i][j] = arr[i][j] + obj[j];
                        }
                    }
                }
            }
        }//dataValuePlus
        //console.log(data);
        //arrEnToZh(data, dataZh);
        function arrEnToZh(data, dataZh) {
            //data是一个数组，里面是对象；
            //dataZh是一个对象
            var newName;
            for (var i = 0; i < data.length; i++) {
                for (var j in data[i]) {
                    if (typeof (data[i][j]) == "string") {
                        if (dataZh[j]) {
                            //console.log(j,data[i][j],dataZh[j]);
                            data[i][dataZh[j]] = data[i][j];
                            delete data[i][j];
                        }
                    }
                }
            }
            console.log(data);
        }//arrEnToZh
        //createPageContent();
        //titleBindStyle();
        function createPageContent() {
            for (var i = 0; i < data.length; i++) {
                var num = 8, flag = 0;//num是最多有几个条目
                var flag2 = 0;
                var wrapHtml = ['	<!--一个村落 start-->',
'			<div class="col-sm-12 infobox-container" id="',
'wrap' + i,
'">',
'</div>'].join("");
                $("#village").append(wrapHtml);

                for (var j in data[i]) {
                    if (j == "name") {
                        var title = ['<h4>',
 data[i][j],
 '</h4>'].join("");
                        $("#wrap" + i).prepend(title);
                    } else {
                        var content = ['	<div col-sm-1 class="infobox infobox-',
aceInfoboxColor[flag2],
'">',
'					<div class="infobox-icon">',
'						<div class="',
aceIcon[0],
'"></div>',
'					</div>',
'					<div class="infobox-data">',
'						<span class="infobox-data-number">',
data[i][j],
'</span>',
'						<div class="infobox-content">',
j,
'</div>',
'					</div>',
'				</div>'].join("");
                        $("#wrap" + i).append(content);
                    }
                    flag++;
                    flag2++;
                    if (flag > aceInfoboxColor.length - 1) {
                        flag2 = 0;
                    }

                }
                for (; flag <= num; flag++) {
                    var nocontent = ['	<div class="infobox infobox-',
aceInfoboxColor[0],
'">',
'					<div class="infobox-icon">',
'						<i class="',
"",
'"></i>',
'					</div>',
'					<div class="infobox-data">',
'						<span class="infobox-data-number">',
"&nbsp;",
'</span>',
'						<div class="infobox-content">',
"&nbsp;",
'</div>',
'					</div>',
'				</div>'].join("");
                    $("#wrap" + i).append(nocontent);
                }
            }
        }
        function titleBindStyle(){
            $("div[id^=\"wrap\"]").mouseover(function (e) {
                var id=$(this).attr("id");
                $("#"+id+" "+"h4").addClass("scale-title");
            });
            $("div[id^=\"wrap\"]").mouseout(function (e) {
                var id = $(this).attr("id");
                $("#" + id + " " + "h4").removeClass("scale-title");
            });
        }
      
    });

</script>






